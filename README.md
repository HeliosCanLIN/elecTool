# electool

## 已经实现的功能:
网页登陆和导入功能,附件判断-检查区域,检查独共享,智能上传附件,批量导入功能,半自动录入,菜单功能,爬取标杆数据

## 可能会加入的功能:
自动出账,检查是否需要录入系统,爬取数据进行分析,超标备注

## 已知的问题

某些金额仍然有小数位数问题

目前账期判断是通过录入前检查缴费模板的缴费期始来判断账期,这在录入一些例如两月一期的缴费时会出现附件错误问题.而通过缴费期终判断的错误率可能高一些,后续可能会更换新的的判断账期方式

录入19年以前账期会出现附件问题 换句话说:录入19年以前的账期仍然是不可用的

在连续录入缴费单时候 按钮元素的xpath位置可能会变动导致找不到按钮元素出现错误 这在录入2020年6月账期时候出现几率较高 原因不明 应该可以通过别的非xpath定位的方式来定位网页元素

全量台帐变动时需要手动复制进报账点数据 然后把 区县 等字眼去掉 例如开发区换成东海 遂溪县换成遂溪

全量内账期201905前后账期数字有点错误 批量导入前需要进报账点数据内修改账期数字
里面账期数字一般都是201903-201905-201905-201906 需要手动修改成201903-201904-201905-201906
导入201905前后账期时候需要注意全量内账期数字有没有错误

获取缴费单号MD5值后应该可以通过post请求来上传附件以及缴费资料(完成此操作可以实现在后台导入缴费)

维护起来稍微有点眼花

## 可能会出现的的问题

因为爬取时候请求速度有点快 可能会存在被服务器拒绝访问的问题


## 使用方法
使用前在config.yaml内完善你缴费文件所在的文件夹,以及录入使用的工号

使用出账工具出账后,软件会从新版导入表内读取数据进行录入 导入期间需要保存一次出账工具 导入程序运行期间不可对出账工具做改动

程序用的导入模板是去除掉数据验证的模板,正常模板内的其他费用项目有数据验证在导入时是会出现问题,手动导入时请使用正常的导入模板

目前只能通过浏览器来进行自动化操作 导入过程中请不要操作电脑

## 


## Change Log

### v0.8.4-beta (2020/09/11)

修复了批量停启用报账点

### v0.8.3-beta (2020/08/24)

爬取电费明细(请求速度较快,谨慎使用)

### v0.8.2-beta (2020/08/21)

爬取审核信息(请求速度较快,谨慎使用) (2020年9月7号-审核框元素信息已发生变动,此段代码还未修改)

### v0.8.1-beta (2020/08/17)
对爬取POST报文注入每日登录时获取的cookie

### v0.8.0-beta (2020/08/14)
爬取标杆(请求速度较快,谨慎使用)

### v0.7.3-beta (2020/08/12)
抛出异常

### v0.7.2-beta (2020/08/11)
从配置文件中读取账号密码~~~~

### v0.7.1-beta (2020/08/11)
引入版本控制

超标备注(非常不可靠)

### v0.7.0-beta (2020/08/10)
18年以前发票和扫描件上传功能(已证实不可用,解决方法可能是整理附件存放结构)

### v0.6.0-beta (2020/08/07)
增加了配置文件,定义用户的缴费文件夹位置

### v0.5.0-beta (2020/08/06)
报账点批量启用(不可靠),打包

### v0.4.0-alpha (2020/08/05)
修复了其他费用因导入模板数据验证导致的无法录入的问题

### v0.3.1-alpha (2020-08-04)
菜单功能

### v0.3.0-alpha (2020-08-03)
批量导入功能 菜单功能

### v0.2.0-alpha (2020-08-02)
附件判断:检查账期-检查独共享 附件上传

### v0.1.1-alpha (2020-08-01)
附件判断-检查区域

### v0.1.0-alpha (2020-07-31)
网页登陆和导入功能

## 需要的库
+ selenium
+ openpyxl
+ pyperclip
+ pywin32
+ pyyaml
+ bs4
+ requests
