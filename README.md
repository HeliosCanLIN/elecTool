# elecAccountImport

## 已经实现的功能:
网页登陆和导入功能,附件判断-检查区域,检查独共享,智能上传附件,批量导入功能,半自动录入,菜单功能,爬取标杆数据

## 可能会加入的功能:
自动出账,检查时候是否需要录入系统,爬取数据进行分析,超标备注,xlsx转移到数据库

## 已知的问题

前一张缴费单导入失败后执行单击html标签操作时会出现错误

某些金额有小数位数问题

目前账期判断是通过录入前检查缴费模板的缴费期始来判断账期,这在录入一些例如两月一期的缴费时会出现附件错误问题.而通过缴费期终判断的错误率更高一些,后续会更换新的的判断账期方式

## 可能会出现的的问题

因为爬取时候请求速度有点快 可能会存在被服务器拒绝访问的问题

## 一些发现
按照我的了解来说MD5编码过程只会发生在前端
如果编码过程发生在后端其实MD5的校验数据的意义就没有了

目前已经在系统js文件内发现了部分HashMD5算法,我对JavaScript语法了解较少,后续再进行研究一个报账点ID是由什么字段编码而来的MD5值
如果能找到MD5编码和生成方式,理论上可以通过发送POST请求的方式录入缴费
目前的录入缴费请求报文是通过 报账点名称和不知道什么逻辑产生的缴费单号 编码而成的MD5来区分缴费
以及附件上传请求同样也是使用由缴费单号产生的MD5值来区分

如果可以解决 后续可以通过修改报文的data部分来直接录入缴费

## 使用方法
使用前在config.yaml内输入你缴费文件所在的文件夹,以及录入使用的工号

使用出账工具出账后,软件会从新版导入表内读取数据进行录入 导入期间需要关闭出账工具和导入模板

导入模板有程序专用版,手动导入时请使用自己的导入模板

目前只能通过浏览器来进行自动化操作 导入过程中请不要操作电脑

## Change Log

### v0.8.3-beta (2020/08/21)
爬取电费明细(请求速度较快,谨慎使用)

### v0.8.2-beta (2020/08/21)
爬取审核信息(请求速度较快,谨慎使用)

### v0.8.1-beta (2020/08/17)
对爬取POST报文注入每日登录时获取的cookie

### v0.8.0-beta (2020/08/14)
爬取标杆(请求速度较快,谨慎使用)

### v0.7.3-beta (2020/08/12)
抛出异常

### v0.7.2-beta (2020/08/11)
从配置文件中读取账号密码~~~~

### v0.7.1-beta (2020/08/11)
引入版本控制

超标备注(非常不可靠)

### v0.7.0-beta (2020/08/10)
18年以前发票和扫描件上传功能

### v0.6.0-beta (2020/08/07)
增加了配置文件,定义用户的缴费文件夹位置

### v0.5.0-beta (2020/08/06)
报账点批量启用(不可靠),打包

### v0.4.0-alpha (2020/08/05)
修复了其他费用因导入模板数据验证导致的无法录入的问题

### v0.3.1-alpha (2020-08-04)
菜单功能

### v0.3.0-alpha (2020-08-03)
批量导入功能 菜单功能

### v0.2.0-alpha (2020-08-02)
附件判断:检查账期-检查独共享 附件上传

### v0.1.1-alpha (2020-08-01)
附件判断-检查区域

### v0.1.0-alpha (2020-07-31)
网页登陆和导入功能

## 需要的库
+ selenium
+ openpyxl
+ pyperclip
+ pywin32
+ pyyaml
+ bs4
+ requests